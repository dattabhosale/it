<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Contact - LeapReplica</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand">LeapReplica</a>
      <nav class="site-nav">
        <a href="index.html">Home</a>
        <a href="products.html">Products</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
      </nav>
      <button class="nav-toggle" aria-label="Toggle navigation">â˜°</button>
    </div>
  </header>

  <main>
    <section class="container">
      <h1>Contact Us</h1>
      <p>For demo purposes, this is a placeholder contact page. Add your contact form or integration here.</p>
      <form class="contact-form">
        <label>Name<br><input type="text" name="name"></label>
        <label>Email<br><input type="email" name="email"></label>
        <label>Message<br><textarea name="message"></textarea></label>
        <p><button class="btn" type="submit">Send</button></p>
      </form>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">Â© 2025 LeapReplica</div>
  </footer>
	<script type='text/javascript'>
  function initEmbeddedMessaging() {
    try {
      embeddedservice_bootstrap.settings.language = "it";
      embeddedservice_bootstrap.settings.displayHelpButton = true;
      embeddedservice_bootstrap.settings.defaultMinimizedText = "Chat with Leappy";
      embeddedservice_bootstrap.settings.disabledMinimizedText = "Leappy Offline";
      
      window.addEventListener("onEmbeddedMessagingReady", () => {
        embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({
          Country: "Italy",
          Language: "it",
          CountryCode: "it",
        });
      });
      
      embeddedservice_bootstrap.init(
        "00DMA000003XnGM",
        "LPM_Leapmotor",
        "https://leapmotor--dev01.sandbox.my.site.com/ESWLPMLeapmotor1760706603231",
        {
          scrt2URL: "https://leapmotor--dev01.sandbox.my.salesforce-scrt.com",
        }
      );
    } catch (err) {
      console.error("Error loading Embedded Messaging: ", err);
    }
  }
  
  (function () {
    console.log("Test custom chat button with Leapmotor carousel");
    
    // Get country code from URL path
    function getCountryFromURL() {
      var path = window.location.pathname;
      var pathParts = path.split('/').filter(function(part) { return part.length > 0; });
      
      if (pathParts.length > 0) {
        var countryCode = pathParts[0].toLowerCase();
        return countryCode;
      }
      return 'en';
    }
    
    // Get localized message based on country
    function getLocalizedMessage(countryCode) {
      var messages = {
        'it': 'Parla con Agentforce! ðŸŽ„',
        'es': 'Habla con Agentforce! ðŸŽ„',
        'fr': 'Parlez avec Agentforce! ðŸŽ„',
        'de': 'Sprechen Sie mit Agentforce! ðŸŽ„',
        'uk': 'Talk with Agentforce! ðŸŽ„',
        'us': 'Talk with Agentforce! ðŸŽ„',
        'en': 'Talk with Agentforce! ðŸŽ„'
      };
      return messages[countryCode] || messages['en'];
    }
    
    // Get localized popup message
    function getLocalizedPopupMessage(countryCode) {
      var popupMessages = {
        'it': 'ðŸ‘‹ Ciao! Hai bisogno di aiuto? Prova la nostra chat!',
        'es': 'ðŸ‘‹ Â¡Hola! Â¿Necesitas ayuda? Â¡Prueba nuestro chat!',
        'fr': 'ðŸ‘‹ Bonjour! Besoin d\'aide? Essayez notre chat!',
        'de': 'ðŸ‘‹ Hallo! Brauchen Sie Hilfe? Probieren Sie unseren Chat!',
        'uk': 'ðŸ‘‹ Hi! Need help? Try our chat!',
        'us': 'ðŸ‘‹ Hi! Need help! Try our chat!',
        'en': 'ðŸ‘‹ Hi! Need help? Try our chat!'
      };
      return popupMessages[countryCode] || popupMessages['en'];
    }
    
    var detectedCountry = getCountryFromURL();
    var buttonMessage = getLocalizedMessage(detectedCountry);
    var popupMessage = getLocalizedPopupMessage(detectedCountry);
    console.log('Detected country:', detectedCountry, '| Message:', buttonMessage);
    
    var chatClicked = false;
    var popupInterval = null;
    var embeddedServiceInstance = null;
    
    // Create notification sound using Web Audio API
    function playNotificationSound() {
      try {
        var audioContext = new (window.AudioContext || window.webkitAudioContext)();
        var oscillator = audioContext.createOscillator();
        var gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.value = 800;
        oscillator.type = 'sine';
        
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.5);
        
        console.log('Notification sound played');
      } catch (e) {
        console.warn('Could not play notification sound:', e);
      }
    }
    
    function hideStandardButton(es) {
      if (es && es.utilAPI && typeof es.utilAPI.hideChatButton === "function") {
        try {
          es.utilAPI.hideChatButton();
          console.log("hideChatButton() called");
        } catch (e) {
          console.warn("Error calling hideChatButton()", e);
        }
      }
    }
    
    function showCustomCTA(es) {
      if (!es || !es.utilAPI) {
        console.warn("utilAPI not available");
        return;
      }
      
      var existing = document.getElementById("leap-chat-cta");
      if (existing) {
        existing.style.display = "inline-flex";
        hideStandardButton(es);
        console.log("Custom CTA shown again");
        return;
      }
      
      // Create button container
      var btn = document.createElement("button");
      btn.id = "leap-chat-cta";
      btn.style.position = "fixed";
      btn.style.right = "14px";
      btn.style.bottom = "24px";
      btn.style.zIndex = "99999";
      btn.style.padding = "28px 48px";
      btn.style.fontSize = "24px";
      btn.style.fontWeight = "700";
      btn.style.borderRadius = "999px";
      btn.style.border = "none";
      btn.style.cursor = "pointer";
      btn.style.boxShadow = "0 12px 32px rgba(0,0,0,0.5), 0 0 60px rgba(255, 215, 0, 0.4)";
      btn.style.background = "linear-gradient(135deg, #c41e3a 0%, #165b33 50%, #c41e3a 100%)";
      btn.style.backgroundSize = "200% 200%";
      btn.style.color = "#ffffff";
      btn.style.display = "inline-flex";
      btn.style.alignItems = "center";
      btn.style.justifyContent = "center";
      btn.style.gap = "18px";
      btn.style.transition = "all 0.3s ease";
      btn.style.overflow = "visible";
      btn.style.fontFamily = "'Arial', sans-serif";
      btn.style.textShadow = "3px 3px 6px rgba(0,0,0,0.4)";
      btn.style.minWidth = "350px";
      btn.style.minHeight = "85px";
      
      // Leapmotor car images carousel
      var iconContainer = document.createElement("div");
      iconContainer.style.position = "relative";
      iconContainer.style.width = "60px";
      iconContainer.style.height = "44px";
      iconContainer.style.display = "flex";
      iconContainer.style.alignItems = "center";
      iconContainer.style.justifyContent = "center";
      iconContainer.style.overflow = "hidden";
      
      // Car image URLs - Replace these with your actual Leapmotor car images
      var carImages = [
        { name: 'C10', url: 'assets/model-a.jpg', color: 'Blue' },
        { name: 'B10', url: 'assets/model-b.jpg', color: 'White' },
        { name: 'T03', url: 'assets/model-c.jpg', color: 'Red' },
        { name: 'B05', url: 'https://via.placeholder.com/120x80/95A5A6/FFFFFF?text=B05', color: 'Silver' }
      ];
      var currentCarIndex = 0;
      
      var carImg = document.createElement("img");
      carImg.src = carImages[0].url;
      carImg.alt = carImages[0].name;
      carImg.style.width = "100%";
      carImg.style.height = "100%";
      carImg.style.objectFit = "contain";
      carImg.style.display = "block";
      carImg.style.transition = "opacity 0.5s ease";
      iconContainer.appendChild(carImg);
      
      // Text content with localized message
      var textSpan = document.createElement("span");
      textSpan.textContent = buttonMessage;
      textSpan.style.letterSpacing = "0.5px";
      
      // Stellantis logo - Replace URL with actual logo
      var logoImg = document.createElement("img");
      logoImg.src = "assets/car-hero.jpg";
      logoImg.alt = "Stellantis";
      logoImg.style.height = "24px";
      logoImg.style.width = "auto";
      logoImg.style.objectFit = "contain";
      logoImg.style.marginLeft = "8px";
      logoImg.style.opacity = "0.9";
      
      btn.appendChild(iconContainer);
      btn.appendChild(textSpan);
      btn.appendChild(logoImg);
      
      // Add CSS animations
      var style = document.createElement("style");
      style.textContent = `
        @keyframes carFadeIn {
          0% { opacity: 0; transform: scale(0.8); }
          100% { opacity: 1; transform: scale(1); }
        }
        
        @keyframes carFadeOut {
          0% { opacity: 1; transform: scale(1); }
          100% { opacity: 0; transform: scale(0.8); }
        }
        
        @keyframes snowfall {
          0% { transform: translateY(-10px) translateX(0); opacity: 0; }
          50% { opacity: 1; }
          100% { transform: translateY(10px) translateX(5px); opacity: 0; }
        }
        
        @keyframes gradientShift {
          0% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
          100% { background-position: 0% 50%; }
        }
        
        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }
        
        @keyframes popupSlideIn {
          0% { opacity: 0; transform: translateY(20px) scale(0.8); }
          100% { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        @keyframes popupBounce {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-5px); }
        }
        
        #leap-chat-cta {
          animation: gradientShift 3s ease infinite, pulse 2s ease-in-out infinite;
        }
        
        #leap-chat-cta:hover {
          transform: scale(1.08) !important;
          box-shadow: 0 12px 32px rgba(0,0,0,0.5), 0 0 60px rgba(255, 215, 0, 0.5) !important;
        }
        
        .chat-popup-tooltip {
          position: fixed;
          right: 32px;
          bottom: 140px;
          background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%);
          color: #333;
          padding: 16px 24px;
          border-radius: 16px;
          box-shadow: 0 8px 24px rgba(0,0,0,0.3), 0 0 40px rgba(196, 30, 58, 0.2);
          z-index: 99998;
          max-width: 280px;
          font-family: 'Arial', sans-serif;
          font-size: 15px;
          font-weight: 600;
          animation: popupSlideIn 0.5s ease, popupBounce 1.5s ease-in-out 0.5s infinite;
          border: 3px solid #c41e3a;
          cursor: pointer;
          transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .chat-popup-tooltip:hover {
          transform: translateY(-2px);
          box-shadow: 0 12px 32px rgba(0,0,0,0.4), 0 0 50px rgba(196, 30, 58, 0.3);
        }
        
        .chat-popup-tooltip::after {
          content: '';
          position: absolute;
          bottom: -12px;
          right: 40px;
          width: 0;
          height: 0;
          border-left: 12px solid transparent;
          border-right: 12px solid transparent;
          border-top: 12px solid #c41e3a;
        }
        
        .chat-popup-close {
          position: absolute;
          top: 8px;
          right: 8px;
          background: #c41e3a;
          color: white;
          border: none;
          border-radius: 50%;
          width: 24px;
          height: 24px;
          font-size: 16px;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          font-weight: bold;
          line-height: 1;
        }
        
        .chat-popup-close:hover {
          background: #a01828;
        }
      `;
      document.head.appendChild(style);
      
      // Car carousel rotation
      setInterval(function () {
        carImg.style.opacity = "0";
        
        setTimeout(function () {
          currentCarIndex = (currentCarIndex + 1) % carImages.length;
          carImg.src = carImages[currentCarIndex].url;
          carImg.alt = carImages[currentCarIndex].name;
          carImg.style.opacity = "1";
          console.log('Showing car:', carImages[currentCarIndex].name, carImages[currentCarIndex].color);
        }, 500);
      }, 3000);
      
      // Snowflakes effect
      function createSnowflake() {
        var snowflake = document.createElement("div");
        snowflake.textContent = "â„";
        snowflake.style.position = "absolute";
        snowflake.style.fontSize = "20px";
        snowflake.style.color = "#ffffff";
        snowflake.style.pointerEvents = "none";
        snowflake.style.animation = "snowfall 2s linear";
        snowflake.style.left = Math.random() * 100 + "%";
        snowflake.style.top = "-10px";
        snowflake.style.opacity = "0";
        
        btn.appendChild(snowflake);
        
        setTimeout(function () {
          if (snowflake.parentNode) {
            snowflake.parentNode.removeChild(snowflake);
          }
        }, 2000);
      }
      
      setInterval(createSnowflake, 800);
      
      btn.addEventListener("mouseenter", function () {
        btn.style.transform = "scale(1.08)";
      });
      
      btn.addEventListener("mouseleave", function () {
        btn.style.transform = "scale(1)";
      });
      
      btn.addEventListener("click", function () {
        chatClicked = true;
        hidePopupTooltip();
        stopPopupInterval();
        
        if (typeof embeddedServiceInstance.utilAPI.launchChat === "function") {
          console.log("launchChat() from CTA");
          var r = embeddedServiceInstance.utilAPI.launchChat();
          if (r && typeof r.then === "function") {
            r.then(function () {
              console.log("Chat launched (Promise resolved)");
            }).catch(function (err) {
              console.error("Error launching chat", err);
            });
          }
        } else {
          console.warn("launchChat() not available");
        }
      });
      
      document.body.appendChild(btn);
      hideStandardButton(es);
      embeddedServiceInstance = es;
      console.log("Custom CTA created with Leapmotor carousel");
      
      startPopupInterval();
    }
    
    function startPopupInterval() {
      setTimeout(function() {
        if (!chatClicked) {
          showPopupTooltip();
        }
      }, 5000);
      
      popupInterval = setInterval(function() {
        if (!chatClicked) {
          showPopupTooltip();
        }
      }, 60000);
    }
    
    function stopPopupInterval() {
      if (popupInterval) {
        clearInterval(popupInterval);
        popupInterval = null;
        console.log('Popup interval stopped');
      }
    }
    
    function showPopupTooltip() {
      var existingPopup = document.getElementById("chat-popup-tooltip");
      if (existingPopup || chatClicked) return;
      
      var popup = document.createElement("div");
      popup.id = "chat-popup-tooltip";
      popup.className = "chat-popup-tooltip";
      popup.textContent = popupMessage;
      
      popup.addEventListener("click", function(e) {
        if (e.target.className === 'chat-popup-close') return;
        
        chatClicked = true;
        hidePopupTooltip();
        stopPopupInterval();
        
        if (embeddedServiceInstance && typeof embeddedServiceInstance.utilAPI.launchChat === "function") {
          console.log("launchChat() from popup");
          var r = embeddedServiceInstance.utilAPI.launchChat();
          if (r && typeof r.then === "function") {
            r.then(function () {
              console.log("Chat launched from popup (Promise resolved)");
            }).catch(function (err) {
              console.error("Error launching chat from popup", err);
            });
          }
        }
      });
      
      var closeBtn = document.createElement("button");
      closeBtn.className = "chat-popup-close";
      closeBtn.textContent = "Ã—";
      closeBtn.addEventListener("click", function(e) {
        e.stopPropagation();
        hidePopupTooltip();
      });
      
      popup.appendChild(closeBtn);
      document.body.appendChild(popup);
      
      playNotificationSound();
      
      setTimeout(function() {
        hidePopupTooltip();
      }, 10000);
      
      console.log("Popup tooltip shown");
    }
    
    function hidePopupTooltip() {
      var popup = document.getElementById("chat-popup-tooltip");
      if (popup) {
        popup.style.animation = "none";
        popup.style.opacity = "0";
        popup.style.transform = "translateY(20px) scale(0.8)";
        setTimeout(function() {
          if (popup.parentNode) {
            popup.parentNode.removeChild(popup);
          }
        }, 300);
        console.log("Popup tooltip hidden");
      }
    }
    
    function hideCustomCTA() {
      var btn = document.getElementById("leap-chat-cta");
      if (btn) {
        btn.style.display = "none";
        console.log("Custom CTA hidden");
      }
    }
    
    window.addEventListener("onEmbeddedMessagingButtonCreated", function () {
      console.log("onEmbeddedMessagingButtonCreated fired");
      var es = window.embeddedservice_bootstrap;
      if (es) {
        showCustomCTA(es);
      }
    });
    
    window.addEventListener("onEmbeddedMessagingWindowMaximized", function () {
      console.log("onEmbeddedMessagingWindowMaximized fired");
      hideCustomCTA();
    });
    
    window.addEventListener("onEmbeddedMessagingWindowMinimized", function () {
      console.log("onEmbeddedMessagingWindowMinimized fired");
      var es = window.embeddedservice_bootstrap;
      if (es) {
        hideStandardButton(es);
        showCustomCTA(es);
      }
    });
    
    function waitForES(maxAttempts, intervalMs) {
      var attempts = 0;
      (function check() {
        attempts++;
        var es = window.embeddedservice_bootstrap;
        if (es && es.utilAPI) {
          console.log("utilAPI ready (initial)");
          showCustomCTA(es);
          return;
        }
        if (attempts >= maxAttempts) {
          console.warn("utilAPI not found after", attempts, "attempts");
          return;
        }
        setTimeout(check, intervalMs);
      })();
    }
    
    if (document.readyState === "complete" || document.readyState === "interactive") {
      waitForES(50, 200);
    } else {
      window.addEventListener("DOMContentLoaded", function () {
        waitForES(50, 200);
      });
    }
  })();
</script>
<script type="text/javascript" src="https://leapmotor--dev01.sandbox.my.site.com/ESWLPMLeapmotor1760706603231/assets/js/bootstrap.min.js" onload="initEmbeddedMessaging()"></script>

</body>
</html>
